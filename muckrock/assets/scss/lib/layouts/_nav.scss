/* Navigation Menu */

// Grey: #D8C9C6
// Red: #D24019

$color-menu: $color-white;
$color-secondary: $color-white;
$color-unselected: $color-black;
$color-selected: $color-blue;

$small-menu-breakpoint: 540px;

@mixin sidebar-controller
{
    $on: table-cell;
    $off: none;
    #menu-button
    {
        display: $on;
    }
    #menu-close
    {
        display: $off;
    }
    #sidebar-menu:target ~ .container
    {
        #menu-button
        {
            display: $off;
        }
        #menu-close
        {
            display: $on;
        }
    }
}

@mixin sidebar-translation($size)
{
    #sidebar-menu
    {
        @include transform(translateX($size));
        &:target
        {
            @include transform(translateX(0));
        }
    }
    #sidebar-menu:target ~ .container
    {
        @include transform(translateX(-$size));
    }
}

@mixin hidden-sidebar
{
    @include sidebar-controller;
    @include sidebar-translation($mobile-menu-width);
    @include media($medium-layout)
    {
        @include sidebar-translation($tablet-menu-width);
    }
    @include media($large-layout)
    {
        @include sidebar-translation(0);
        nav.primary ul.right
        {
            display: none;
            opacity: 0;
            @include transition($menu-animation);
        }

    }
}

@mixin global-sidebar
{
    .container
    {
        display: block;
        width: 100%;
        @include transition($menu-animation);
    }
    #sidebar-menu
    {
        display: block;
        position: fixed;
        top: 0;
        right: 0;
        z-index: 5;
        width: $mobile-menu-width;
        @include media($medium-layout)
        {
            width: $tablet-menu-width;
        }
        @include media($large-layout)
        {
            width: $desktop-menu-width;
            & + .container {
                padding-right: $desktop-menu-width;
            }
        }
        height: 100%;
        @include transition($menu-animation);
    }
    #muckrock-text
    {
        @include transition($menu-animation);
    }

    @include hidden-sidebar;
}

nav.primary {
    overflow: hidden;
    ul {
        display: table;
        list-style-type: none;
        margin: 0;
        padding-left: 0;
        &.left
        {
            float: left;
        }
        &.right
        {
            display: table;
            float: right;
        }
    }
    #new-request > .button {
        @include border-left-radius($base-border-radius);
        @include border-right-radius(0);
        border-right: none;
    }
    #menu-button > .button, #menu-close > .button {
        @include border-right-radius($base-border-radius);
        @include border-left-radius(0);
        border-left: none;
    }
    .menu-text { display: none; }
    @media screen
    and (min-width: $small-menu-breakpoint - 200px) {
        .menu-text { display: inline; }
    }

    /* Logo */

    %logo {
        margin: $vertical-rhythm/4 0;
        border: none;
        padding: 0 0.5em 0 0;
        svg > path, svg > g { fill: $color-black; }
        &:hover {
            background: none;
            svg > path, svg > g { fill: $color-selected; }
        }
    }
    #muckrock-text { @extend %logo; display: none; }
    #muckrock-icon { @extend %logo;
        display: block;
        padding-top: 0em;
        > svg {
            display: block;
            height: 2rem;
            width: 2rem;
        }
    }
    @media screen and (min-width: 680px) {
        #muckrock-text {
            display: block;
            padding-top: 0.375em;
            padding-right: 1em;
        }
        #muckrock-icon { display: none; }
    }
}

@include global-sidebar;

nav.secondary {
    ul {
        width: 100%;
        display: block;
        padding-left: 0;
    }
    li {
        display: inline-block;
        margin: 0 0.25em;
        &:first-child {
            margin-left: 0;
        }
    }
    a {
        position: relative;
        padding-right: 0.5em;
        color: $color-unselected;
        &:hover {
            color: $color-selected;
            text-decoration: none;
            -webkit-box-shadow: 0px 2px 0px 0px $color-selected;
            -moz-box-shadow:    0px 2px 0px 0px $color-selected;
            box-shadow:         0px 2px 0px 0px $color-selected;
        }
        @media all and (min-width: 400px) { padding-right: 1em; }
        @media all and (min-width: 500px) { padding-right: 2em; }
        @media all and (min-width: 600px) { padding-right: 4em; }
        @media all and (min-width: 700px) { padding-right: 5.5em; }

        @include transition (all 0.2s ease-in-out);
    }
    @media screen and (min-width: $small-menu-breakpoint ) {
        li {
            text-align: left;
            // padding-right: 10%;
        }
    }
}

.footer-container {
    display: block;
    width: 100%;

    border-top: 1px solid $color-grey;
    padding-top: $vertical-rhythm;

    .logo {
        display: inline-block;
        margin-bottom: $vertical-rhythm;
        svg > path, svg > g { fill: $color-black; }
        &:hover {
            svg > path, svg > g { fill: $color-blue; }
        }

    }

    footer {
        @include outer-container();
        .brand {
            @include fill-parent();
            @include media($large-layout) { @include span-columns(4); }
        }
        .sitemap, .about, .actions, .feeds {
            @include fill-parent();
            @include media($medium-layout) { @include span-columns(2); }
            @include media($large-layout) { @include span-columns(2); }
        }
        .sitemap {
            @include media($large-layout) {
                @include shift(2);
            }
        }
    }
    @include media($large-layout) {
        footer section.about { padding-right: 3em; }
    }
    ul {
        list-style-type: none;
        padding-left: 0;
    }
    li {
        @include font-sizing(0.9, 3);
        margin: $vertical-rhythm/2 0;
    }
    p { margin-top: 0; }
    .copyright {
        margin: $vertical-rhythm 0;
        color: $color-black;
    }
}

nav.sidebar {
    $sidebar-object-height: 2.5rem;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    height: 100%;
    width: 100%;
    padding: $vertical-rhythm/2;
    @media screen and (min-width: 540px) {
        padding: $vertical-rhythm $vertical-rhythm 1em;
    }
    color: $color-white;
    background: $color-grey-1;

    dfn { padding: 1.5em 0 0.5em 0; }

    ul { @include row; }
    li { @extend %half; }
    .button {
        @include button($color-grey-3);
        display: block;
        height: $sidebar-object-height;
        width: 100%;
        margin-bottom: $vertical-rhythm/4;
        padding: $vertical-rhythm/4 $vertical-rhythm/2;
    }

    .button-list {
        display: block;
        margin-top: $vertical-rhythm/2;
        li {
            @extend %full;
            &:first-child a {
                border-top: none;
                @include border-top-radius($base-border-radius);
            }
            &:last-child a {
                @include border-bottom-radius($base-border-radius);
            }
        }
        a, .button {
            margin: 0;
            border-radius: 0;
            border-top: $base-border-width solid $color-black;
        }

    }

    .updated a, .updated .button {
        text-align: left;
        text-align:left;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .broadcast {
        position: relative;
        margin-top: 0;
        font-size: 0.9em;
        color: $color-black;
        background-color: $color-white;
        box-shadow: 1px 1px 10px black;
        h1, h2, h3, h4, h5, h6, p {
            width: 95%;
        }
        p:last-of-type {
            margin-bottom: 0;
        }

        #close-broadcast {
            position: absolute;
            top: 5%;
            right: 5%;
            font-size: 1.5em;
            color: $color-grey;
            cursor: pointer;
            &:hover {
                color: $color-black;
            }
        }
    }

    .account {
        margin-top: 2 * $vertical-rhythm;
        .username {
            display: block;
            @extend .h3;
            color: $color-white;
        }
        .options {
            @include row;
            padding-left: 0;
            margin-bottom: 0;
            #mylist { @extend %full; }
        }


        .account-info {
            display: block;
            height: auto;
            margin: $vertical-rhythm 0 0;
            border: none;
            padding: 0;
            background: none;
            text-align: left;
            color: $color-white;
            text-decoration: none;

            .counter {
                margin-right: $vertical-rhythm/4;
                padding: $vertical-rhythm/5 $vertical-rhythm/2;
                border-radius: 1.5em;
                font-weight: $font-weight-bold;
                text-align: center;
                color: $color-white;
                background: $color-grey-4;
            }
            &:hover {
                color: $color-blue;
                .counter {
                    background: $color-blue;
                }
            }
        }

    }

    .social-links {
        a {
            svg {
                height: 1em;
                width: auto;
                margin-bottom: -0.1em;
                fill: $color-grey;
            }
            &:hover {
                background: $color-selected;
                svg { fill: $color-white; }
            }
        }
    }

    .spotlight {
        margin-top: 1.5em;
        img { margin: 0; }
        h1 {
            @extend h6;
            font-weight: $font-weight-normal;
            font-size: 98%;
            line-height: 1.2em;
        }
        p { @extend small; line-height: 1.2em; }
    }

    form {
        display: block;
        width: 100%;
        height: $sidebar-object-height;
        margin: 0 0 $vertical-rhythm/2;
        input {
            @include appearance(none);
            width: 75%;
            height: 100%;
            float: left;
            margin-right: 0;
            font-size: 0.9em;
            color: $color-white;
            background: $color-grey-3;
            @include placeholder { color: $color-grey; }
            border: $base-border-width solid $color-grey-3;
            @include border-right-radius(0);
            transform: translateY(2px);
            &:focus, &:hover {
                outline: none;
                border-color: $color-selected;
            }
            & + span.input-button {
                @include button($color-grey-2);
                margin: 0;
                float: right;
                clear: right;
                height: 100%;
                width: 25%;
                @include border-right-radius($base-border-radius);
                @include border-left-radius(0);
                cursor: pointer;
                svg {
                    display: inline-block;
                    height: 1.25em;
                    width: auto;
                    margin-left: -.25em;
                    vertical-align: middle;
                    fill: $color-grey;
                }
            }
        }
    }
}
