{% load tags %}

{% if communication %}
<section class="{% if communication.response %}received{% else %}sent{% endif %} communication {% if communication.from_who == 'MuckRock.com' %}collapsed{% endif %}" id="{{ communication.anchor }}">
    <header class="communication-header">
        <h1 class="from">From: {{ communication.from_who }}</h1>
        <div class="actionables">
            <a href="{{ request.path }}#{{ communication.anchor }}" class="permalink"><time datetime="{{ communication.date|date:'c' }}" class="date">{{ communication.date | date:"m/d/Y" }}</time></a>
            {% if request.user.is_staff %}
            <div class="options dropdown">
                {% include 'lib/icons/options.svg' %}
                <ul class="options dropdown-list">
                    {% if comm.rawemail.raw_email %}<li><a href="{% url 'foia-raw' idx=comm.pk %}" class="option">Raw Email</a></li>{% endif %}
                    <li onClick="console.log('Move');" class="option">Move</li>
                    <li onClick="console.log('Resend');" class="option">Resend</li>
                    <li onClick="console.log('Delete');" class="option">Delete</li>
                </ul>
            </div>
            {% endif %}
        </div>
    </header>
    {% if communication.communication %}
    <section class="communication-body">
        {% if communication.subject %}
        <header class="communication-body-header">
            <p class="subject">Subject: {{ communication.subject }}</p>
        </header>
        {% endif %}
        {% if communication.full_html %}
        {{ communication.communication|redact_emails }}
        {% else %}
        {{ communication.communication|redact_emails|urlize|linebreaks }}
        {% endif %}
    </section>
    {% endif %}
    {% if communication.files.count > 0 %}
    <ul class="files">
    {% for file in communication.files.all %}
        <li>{% include 'lib/file.html' %}</li>
    {% endfor %}
    </ul>
    {% endif %}
</section>
{% endif %}
