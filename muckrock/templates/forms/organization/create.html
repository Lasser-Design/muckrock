{% extends 'forms/base_form.html' %}
{% load static from staticfiles %}
{% block title %}MuckRock &bull; Create an Organization{% endblock %}
{% block form-type %}organization{% endblock %}
{% block form-title %}Create an Organization{% endblock %}

{% block form-info %}
<p><small>Organization subscriptions allow you to share a pool of requests with up to 50 other MuckRock users. Organization subscriptions are $450 per month, and the subscription will be associated with your MuckRock account.</small></p>
{% endblock form-info %}

{% block form-form %}
<form method="post" id="org-create-form">
    {% csrf_token %}
    {% if form.non_field_errors %}
    <object class="failure panel">
    {{ form.non_field_errors }}
    </object>
    {% endif %}
    <div class="hidden-fields">
    {% for field in form.hidden_fields %}
        {{ field }}
    {% endfor %}
    </div>
    <div class="visible-fields">
    {% for field in form.visible_fields %}
        <fieldset class="{{ field.label|lower }}{% if field.field.required %} required{% endif %}">
            <label {% if field.errors %}class="failure"{% endif %} for="{{ field.auto_id }}">{{ field.label}}</label>
            {{ field.errors }}
            {{ field }}
            {% if field.help_text %}<p class="default"><small>{{ field.help_text }}</small></p>{% endif %}
        </fieldset>
    {% endfor %}
    </div>
    <button data-amount=""
        data-description="Org. subscription ($450/month)"
        data-email="{{ request.user.email }}"
        data-label="Subscribe"
        data-form="#org-create-form"
        class="checkout-button primary">
        Create Organization
    </button>    
</form>
{% endblock form-form %}

{% block styles %}
<script type="text/javascript" src="https://checkout.stripe.com/checkout.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $('.checkout-button').click(function(e){
            e.preventDefault();
            checkoutData = getCheckoutData($(this));
            checkout(
                "{{ stripe_pk }}",
                "{% static 'apple-touch-icon.png' %}",
                checkoutData.description,
                checkoutData.amount,
                checkoutData.email,
                checkoutData.label,
                checkoutData.form
            );
        });
    });
</script>
{% endblock styles %}