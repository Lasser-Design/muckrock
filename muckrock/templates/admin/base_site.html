{% extends "admin/base.html" %}

{% block extrahead %}
    <script src="/static/js/jquery-1.8.3.js" type="text/javascript"></script>
    {% include 'autocomplete_light/static.html' %}
		<script type="text/javascript">
		$(document).ready(function() {
				value = $('.autocomplete-light-widget select[name$=jurisdiction]').val();
				var agencySelectElement = $('.autocomplete-light-widget select[name$=agency]');
				var agencyWidgetElement = agencySelectElement.parents('.autocomplete-light-widget');
				if (value) {
						// If value is contains something, add it to autocomplete.data
						agencyWidgetElement.yourlabsWidget().autocomplete.data = {
								'jurisdiction_id': value[0],
						};
				} else {
						// If value is empty, empty autocomplete.data
						agencyWidgetElement.yourlabsWidget().autocomplete.data = {}
				}
				$('body').on('change', '.autocomplete-light-widget select[name$=jurisdiction]', function() {
						var agencySelectElement = $('#' + $(this).attr('id').replace('jurisdiction', 'agency'));
						var agencyWidgetElement = agencySelectElement.parents('.autocomplete-light-widget');

						// When the country select changes
						value = $(this).val();

						if (value) {
								// If value is contains something, add it to autocomplete.data
								agencyWidgetElement.yourlabsWidget().autocomplete.data = {
										'jurisdiction_id': value[0],
								};
						} else {
								// If value is empty, empty autocomplete.data
								agencyWidgetElement.yourlabsWidget().autocomplete.data = {}
						}

						// example debug statements, that does not replace using breakbpoints and a proper debugger but can hel
						// console.log($(this), 'changed to', value);
						// console.log(agencyWidgetElement, 'data is', agencyWidgetElement.yourlabsWidget().autocomplete.data)
				})
		});
		</script>
{% endblock %}
