
{% extends base %}

{% load tags %}

{% block content %}
	<h1>{{ title }}</h1>

	<div class="post-meta archive-pagination">
	{% with request.GET.order as ord %}
	{% with request.GET.field as field %}
		
		<div class="nav-left">
			{% if page_obj.has_previous %}
			<a href="?page=1{%if ord%}&order={{ord}}{%endif%}{%if field%}&field={{field}}{%endif%}">&#171; First page</a>
			&nbsp; &nbsp;
			<a href="?page={{page_obj.previous_page_number}}{%if ord%}&order={{ord}}{%endif%}{%if field%}&field={{field}}{%endif%}">&#171; Previous page</a>
			{% else %}
			&nbsp;
			{% endif %}
		</div>
		<div class="nav-center">
			{% page_links page_obj %}
		</div>
		{% if page_obj.has_next %}
		<div class="nav-right">
			<a href="?page={{page_obj.next_page_number}}{%if ord%}&order={{ord}}{%endif%}{%if field%}&field={{field}}{%endif%}">Next page &#187;</a>
			&nbsp; &nbsp;
			<a href="?page={{paginator.num_pages}}{%if ord%}&order={{ord}}{%endif%}{%if field%}&field={{field}}{%endif%}">Last page &#187;</a>
		</div>
		{% endif %}

		<div class="clearer">&nbsp;</div>
		
	{% endwith %}
	{% endwith %}
	</div>

	<table class="data-table">
		<tr class="odd">
			{% if request.GET.field == 'title' and request.GET.order == 'asc' %}
				<th width="40%"><a href="?order=desc&field=title">Title</a></th>
			{% else %}
				<th width="40%"><a href="?order=asc&field=title">Title</a></th>
			{% endif %}
			{% if request.GET.field == 'user' and request.GET.order == 'asc' %}
				<th width="10%"><a href="?order=desc&field=user">User</a></th>
			{% else %}
				<th width="10%"><a href="?order=asc&field=user">User</a></th>
			{% endif %}
			{% if request.GET.field == 'status' and request.GET.order == 'asc' %}
				<th width="15%"><a href="?order=desc&field=status">Status</a></th>
			{% else %}
				<th width="15%"><a href="?order=asc&field=status">Status</a></th>
			{% endif %}
			{% if request.GET.field == 'jurisdiction' and request.GET.order == 'asc' %}
				<th width="20%"><a href="?order=desc&field=jurisdiction">Jurisdiction</a></th>
			{% else %}
				<th width="20%"><a href="?order=asc&field=jurisdiction">Jurisdiction</a></th>
			{% endif %}
			{% if request.GET.field == 'date_submitted' and request.GET.order == 'asc' %}
				<th width="15%"><a href="?order=desc&field=date">Date</a></th>
			{% else %}
				<th width="15%"><a href="?order=asc&field=date">Date</a></th>
			{% endif %}
		</tr>
		{% for foia in object_list %}
		<tr class="{% cycle 'even' 'odd' %}">
			<td><a href="{% url foia-detail jurisdiction=foia.jurisdiction.slug,idx=foia.id,slug=foia.slug %}">{{ foia.title }}</a></td>
			<td><a href="{% url acct-profile foia.user.username %}">{{ foia.user }}</a></td>
			<td><span class="request-{{foia.color_code}}">{{ foia.get_status_display }}</span></td>
			<td>{{ foia.jurisdiction }}</td>
			<td>{{ foia.date_submitted|date }}</td>
		</tr>
		{% endfor %}
	</table>

	<div class="post-meta archive-pagination">
	{% with request.GET.order as ord %}
	{% with request.GET.field as field %}
		
		<div class="nav-left">
			{% if page_obj.has_previous %}
			<a href="?page=1{%if ord%}&order={{ord}}{%endif%}{%if field%}&field={{field}}{%endif%}">&#171; First page</a>
			&nbsp; &nbsp;
			<a href="?page={{page_obj.previous_page_number}}{%if ord%}&order={{ord}}{%endif%}{%if field%}&field={{field}}{%endif%}">&#171; Previous page</a>
			{% else %}
			&nbsp;
			{% endif %}
		</div>
		<div class="nav-center">
			{% page_links page_obj %}
		</div>
		{% if page_obj.has_next %}
		<div class="nav-right">
			<a href="?page={{page_obj.next_page_number}}{%if ord%}&order={{ord}}{%endif%}{%if field%}&field={{field}}{%endif%}">Next page &#187;</a>
			&nbsp; &nbsp;
			<a href="?page={{paginator.num_pages}}{%if ord%}&order={{ord}}{%endif%}{%if field%}&field={{field}}{%endif%}">Last page &#187;</a>
		</div>
		{% endif %}

		<div class="clearer">&nbsp;</div>
		
	{% endwith %}
	{% endwith %}
	</div>

{% endblock %}

